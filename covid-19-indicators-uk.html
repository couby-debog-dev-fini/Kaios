<!DOCTYPE html>
<html>
  <head>
    <title>UK COVID-19 indicators</title>
    <script src="https://cdn.jsdelivr.net/npm/vega@5.10.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@4.7.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.3.2"></script>
  </head>
  <body>
    <table>
      <tr>
        <td>
          <div id="p1"></div>
          <div id="p2"></div>
          <div id="p3"></div>
        </td>
      </tr>
      <tr>
        <td>
          <div id="p4"></div>
          <div id="p5"></div>
          <div id="p6"></div>
        </td>
      </tr>
      <tr>
        <td>
          <div id="p7"></div>
          <div id="p8"></div>
          <div id="p9"></div>
        </td>
      </tr>
    </table>
    <a href="index.html">Home</a>
    <script type="text/javascript">
      const p1 = {
        $schema: "https://vega.github.io/schema/vega-lite/v4.json",
        description: "UK daily people tested",
        width: 300,
        data: {
          url:
            "https://raw.githubusercontent.com/tomwhite/covid-19-uk-data/master/data/covid-19-tests-uk.csv",
        },
        transform: [
          {
            window: [{ op: "lag", field: "TotalPeopleTested", as: "Prev" }],
          },
          {
            calculate:
              "if(datum.Prev == null, NaN, if(datum.TotalPeopleTested === '', NaN, datum.TotalPeopleTested) - datum.Prev)",
            as: "DailyTestsDifference",
          },
          {
            calculate:
              "if(datum.DailyPeopleTested === '', datum.DailyTestsDifference, datum.DailyPeopleTested)",
            as: "DailyTests",
          },
        ],
        mark: "line",
        encoding: {
          x: { field: "Date", type: "temporal" },
          y: {
            field: "DailyTests",
            type: "quantitative",
            title: "Daily people tested",
          },
        },
      };
      const p2 = {
        $schema: "https://vega.github.io/schema/vega-lite/v4.json",
        description: "UK cumulative people tested",
        width: 300,
        data: {
          url:
            "https://raw.githubusercontent.com/tomwhite/covid-19-uk-data/master/data/covid-19-indicators-uk.csv",
        },
        transform: [
          {
            filter: "datum.Country == 'UK' && datum.Indicator == 'Tests'",
          },
        ],
        mark: "line",
        encoding: {
          x: { field: "Date", type: "temporal" },
          y: {
            field: "Value",
            type: "quantitative",
            title: "Cumulative people tested",
          },
        },
      };
      const p3 = {
        $schema: "https://vega.github.io/schema/vega-lite/v4.json",
        description: "UK cumulative people tested (log scale)",
        width: 300,
        data: {
          url:
            "https://raw.githubusercontent.com/tomwhite/covid-19-uk-data/master/data/covid-19-indicators-uk.csv",
        },
        transform: [
          {
            filter: "datum.Country == 'UK' && datum.Indicator == 'Tests'",
          },
        ],
        mark: "line",
        encoding: {
          x: { field: "Date", type: "temporal" },
          y: {
            field: "Value",
            type: "quantitative",
            scale: { type: "log" },
            title: "Cumulative people tested",
          },
        },
      };
      const p4 = {
        $schema: "https://vega.github.io/schema/vega-lite/v4.json",
        description: "UK daily confirmed cases",
        width: 300,
        data: {
          url:
            "https://raw.githubusercontent.com/tomwhite/covid-19-uk-data/master/data/covid-19-indicators-uk.csv",
        },
        transform: [
          {
            filter:
              "datum.Country == 'UK' && datum.Indicator == 'ConfirmedCases'",
          },
          {
            window: [{ op: "lag", field: "Value", as: "Prev" }],
          },
          {
            calculate: "if(datum.Prev == null, NaN, datum.Value - datum.Prev)",
            as: "DailyCases",
          },
        ],
        mark: "line",
        encoding: {
          x: { field: "Date", type: "temporal" },
          y: {
            field: "DailyCases",
            type: "quantitative",
            title: "Daily confirmed cases",
          },
        },
      };
      const p5 = {
        $schema: "https://vega.github.io/schema/vega-lite/v4.json",
        description: "UK cumulative confirmed cases",
        width: 300,
        data: {
          url:
            "https://raw.githubusercontent.com/tomwhite/covid-19-uk-data/master/data/covid-19-indicators-uk.csv",
        },
        transform: [
          {
            filter:
              "datum.Country == 'UK' && datum.Indicator == 'ConfirmedCases'",
          },
        ],
        mark: "line",
        encoding: {
          x: { field: "Date", type: "temporal" },
          y: {
            field: "Value",
            type: "quantitative",
            title: "Cumulative confirmed cases",
          },
        },
      };
      const p6 = {
        $schema: "https://vega.github.io/schema/vega-lite/v4.json",
        description: "UK cumulative confirmed cases (log scale)",
        width: 300,
        data: {
          url:
            "https://raw.githubusercontent.com/tomwhite/covid-19-uk-data/master/data/covid-19-indicators-uk.csv",
        },
        transform: [
          {
            filter:
              "datum.Country == 'UK' && datum.Indicator == 'ConfirmedCases'",
          },
          {
            calculate: "if(datum.Value == 0, NaN, datum.Value)",
            as: "ConfirmedCases",
          },
        ],
        mark: "line",
        encoding: {
          x: { field: "Date", type: "temporal" },
          y: {
            field: "ConfirmedCases",
            type: "quantitative",
            scale: { type: "log" },
            title: "Cumulative confirmed cases",
          },
        },
      };
      const p7 = {
        $schema: "https://vega.github.io/schema/vega-lite/v4.json",
        description: "UK daily deaths",
        width: 300,
        data: {
          url:
            "https://raw.githubusercontent.com/tomwhite/covid-19-uk-data/master/data/covid-19-indicators-uk.csv",
        },
        transform: [
          {
            filter: "datum.Country == 'UK' && datum.Indicator == 'Deaths'",
          },
          {
            window: [{ op: "lag", field: "Value", as: "Prev" }],
          },
          {
            calculate: "datum.Value - datum.Prev",
            as: "DailyDeaths",
          },
        ],
        mark: "line",
        encoding: {
          x: { field: "Date", type: "temporal" },
          y: {
            field: "DailyDeaths",
            type: "quantitative",
            title: "Daily deaths",
          },
        },
      };
      const p8 = {
        $schema: "https://vega.github.io/schema/vega-lite/v4.json",
        description: "UK cumulative deaths",
        width: 300,
        data: {
          url:
            "https://raw.githubusercontent.com/tomwhite/covid-19-uk-data/master/data/covid-19-indicators-uk.csv",
        },
        transform: [
          {
            filter: "datum.Country == 'UK' && datum.Indicator == 'Deaths'",
          },
        ],
        mark: "line",
        encoding: {
          x: { field: "Date", type: "temporal" },
          y: {
            field: "Value",
            type: "quantitative",
            title: "Cumulative deaths",
          },
        },
      };
      const p9 = {
        $schema: "https://vega.github.io/schema/vega-lite/v4.json",
        description: "UK cumulative deaths (log scale)",
        width: 300,
        data: {
          url:
            "https://raw.githubusercontent.com/tomwhite/covid-19-uk-data/master/data/covid-19-indicators-uk.csv",
        },
        transform: [
          {
            filter: "datum.Country == 'UK' && datum.Indicator == 'Deaths'",
          },
          {
            calculate: "if(datum.Value == 0, NaN, datum.Value)",
            as: "Deaths",
          },
        ],
        mark: "line",
        encoding: {
          x: { field: "Date", type: "temporal" },
          y: {
            field: "Deaths",
            type: "quantitative",
            scale: { type: "log" },
            title: "Cumulative deaths",
          },
        },
      };
      vegaEmbed("#p1", p1);
      vegaEmbed("#p2", p2);
      vegaEmbed("#p3", p3);
      vegaEmbed("#p4", p4);
      vegaEmbed("#p5", p5);
      vegaEmbed("#p6", p6);
      vegaEmbed("#p7", p7);
      vegaEmbed("#p8", p8);
      vegaEmbed("#p9", p9);
    </script>
  </body>
</html>
